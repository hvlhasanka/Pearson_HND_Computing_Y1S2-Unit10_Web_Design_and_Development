<!-- PHP - Server Side -->
<?php

// Including the database connection file once, to establish database connection
include_once("LSULibraryDBConnection.php");

// Checking if the 'Submit' button was clicked
if(isset($_POST['submit'])){

  // Retrieving user entered and selected data from the form
  $enteredUsername = $_POST['username'];
  $enteredPassword = $_POST['password'];
  $selectedMembershipType = $_POST['membershipType'];

  // Checking if 'Username' and  'Password' fields are empty, and if 'MembershipType' Select returned 'NULL'
  if(empty($enteredUsername) || empty($enteredPassword) || $selectedMembershipType == 'NULL'){

    // Individually checking error type to show specific error meesage

    if(empty($enteredUsername)){
      echo "<script type='text/javascript'>
        alert('<font style='text-decoration: underline; font-weight: bold; font-size: 20px;'>USERNAME</font>USERNAME Field is Empty');
      </script>";
    }
    if(empty($enteredPassword)){
      echo "PASSWORD Field is Empty";
    }
    if($selectedMembershipType == 'NULL'){
      echo "Membership Type not selected";
    }
    include("loginPage.html");

  }
  else {
    // Retrieving MembershipTypeID from LoginMembershipType Relation in the database for the selected Membership Type
    $sqlQueryMembershipTypeID = "SELECT * FROM LoginMembershipType WHERE MembershipType = '$selectedMembershipType'";

    // Executing SQL query and assinging to the variable
    $resultMembershipTypeID = mysqli_query($databaseConn, $sqlQueryMembershipTypeID );

    // Retrieving tha values and placing them on an array
    $resultArrayMembershipTypeID = mysqli_fetch_array($resultMembershipTypeID);

    // Retrieving value from the array by mentioning the index name
    $databaseMembershipTypeID = $resultArrayMembershipTypeID['MembershipTypeID'];



    // Retrieving login credentials from database based on the entered Username
    // Assigning SQL query to this variable
    $sqlQuery = "SELECT * FROM SystemLogin WHERE Username = '$enteredUsername" AND MembershipType;

    // Executing SQL query and assinging to the variable
    $result = mysqli_query($databaseConn, $sqlQuery);

    $resultArray = mysqli_fetch_array($result);

    // Retrieving values from database and assigning them
    $databasePassword = $resultArray['Password'];

  }
}

?>

<!-- HTML - Client Side -->
<!DOCTYPE html>
<html>
  <head>
    <title> LSU Library - Login </title>
  </head>
  <body>
<?php
echo "<script type='text/javascript'>
  alert('Username Field was Empty');
</script>";
?>
    <div id="main">

      <p>Login</p>

      <div id="loginForm">
        <form method="POST" action="#">
          <p>Username:
            <input type="text" name="username" placeholder="Enter your USERNAME" required pattern="[A-Za-z0-9_]{12,15}"
             title="Enter Only Uppercase or Lowercase Alphabetic Characters or Numeric Values. Minimum Length: 12. Maximum Length: 15.">
          </p>
          <p>Password:
            <input type="password" name="password" placeholder="Enter your PASSWORD" required pattern="[A-Za-z][0-9]+.{10,15}">
          </p>
          <p>Membership Type:
            <select name="membershipType">
              <option value="NULL">Select a Category</option>
              <option value="Student">Student</option>
              <option value="Professor">Professor</option>
              <option value="Librarian">Librarian</option>
            </select>
          </p>
          <input type="submit" name="submit" value="Submit">
          <input type="reset" name="reset" value="Clear">
        </form>
      </div>

    </div>

  </body>
</html>
